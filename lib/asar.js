// Generated by CoffeeScript 1.8.0
var AsarArchive, createArchive, createReadStream, extractArchive, getEntries, loadArchive, opts, serialization, verifyArchive;

AsarArchive = require('./archive');

serialization = require('./serialization');

opts = {};

createArchive = function(srcDir, archiveFilename, pattern, cb) {
  var archive;
  if (typeof pattern === 'function') {
    cb = pattern;
    pattern = null;
  }
  archive = new AsarArchive(opts);
  if (srcDir != null) {
    archive.addDirectory(srcDir, {
      pattern: pattern
    }, function(err) {
      if (archiveFilename != null) {
        return archive.write(archiveFilename, function(err) {
          return cb(err, archive);
        });
      }
    });
  }
};

loadArchive = function(archiveFilename) {
  var archive;
  archive = new AsarArchive(opts);
  return serialization.loadArchive(archive, archiveFilename);
};

verifyArchive = function(archiveFilename, cb) {
  loadArchive(archiveFilename).verify(cb);
};

getEntries = function(archiveFilename, archiveRoot, pattern) {
  if (archiveRoot == null) {
    archiveRoot = '/';
  }
  if (pattern == null) {
    pattern = null;
  }
  return loadArchive(archiveFilename).getEntries(archiveRoot, pattern);
};

extractArchive = function(archiveFilename, destDir, opts, cb) {
  loadArchive(archiveFilename).extract(destDir, opts, cb);
};

createReadStream = function(archiveFilename, filename) {
  return loadArchive(archiveFilename).createReadStream(filename);
};

module.exports = {
  AsarArchive: AsarArchive,
  createArchive: createArchive,
  loadArchive: loadArchive,
  verifyArchive: verifyArchive,
  getEntries: getEntries,
  extractArchive: extractArchive,
  createReadStream: createReadStream,
  opts: opts
};
